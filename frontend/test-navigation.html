<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Navigation Test - Vaulture</title>
    <link rel="stylesheet" href="css/main.css" />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <a href="index.html" class="logo">Vaulture</a>

        <div class="nav-actions">
          <!-- Logged out state -->
          <div class="nav-actions-logged-out" id="navLoggedOut">
            <a href="login.html" class="btn btn-secondary">Log in</a>
            <a href="signup.html" class="btn btn-primary">Start selling</a>
          </div>

          <!-- Logged in state -->
          <div class="nav-actions-logged-in" id="navLoggedIn">
            <!-- This will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main style="padding-top: 100px; padding: 100px 20px 20px">
      <div class="container">
        <h1>Navigation Test Page</h1>

        <div style="margin: 20px 0">
          <h3>Auth State Debug</h3>
          <p>Token exists: <span id="tokenStatus">Checking...</span></p>
          <p>
            Logged out nav display:
            <span id="loggedOutDisplay">Checking...</span>
          </p>
          <p>
            Logged in nav display: <span id="loggedInDisplay">Checking...</span>
          </p>
        </div>

        <div style="margin: 20px 0">
          <h3>Test Actions</h3>
          <button
            onclick="clearAllAuthData()"
            class="btn btn-secondary"
            style="margin-right: 10px"
          >
            Clear Auth Data
          </button>
          <button
            onclick="simulateLogin()"
            class="btn btn-primary"
            style="margin-right: 10px"
          >
            Simulate Login
          </button>
          <button onclick="updateNavigationState()" class="btn btn-secondary">
            Update Navigation
          </button>
        </div>

        <div style="margin: 20px 0">
          <h3>Manual Navigation State Check</h3>
          <pre
            id="debugInfo"
            style="background: #f5f5f5; padding: 10px; border-radius: 4px"
          ></pre>
        </div>
      </div>
    </main>

    <script src="js/main.js"></script>
    <script>
      // Test functions
      function simulateLogin() {
        localStorage.setItem("authToken", "fake-token-for-testing");
        localStorage.setItem(
          "userProfile",
          JSON.stringify({
            display_name: "Test User",
            email: "test@example.com",
          })
        );
        updateNavigationState();
        updateDebugInfo();
      }

      function updateDebugInfo() {
        const token = localStorage.getItem("authToken");
        const loggedOut = document.getElementById("navLoggedOut");
        const loggedIn = document.getElementById("navLoggedIn");

        document.getElementById("tokenStatus").textContent = !!token
          ? "Yes"
          : "No";
        document.getElementById("loggedOutDisplay").textContent = loggedOut
          ? getComputedStyle(loggedOut).display
          : "Element not found";
        document.getElementById("loggedInDisplay").textContent = loggedIn
          ? getComputedStyle(loggedIn).display
          : "Element not found";

        const debugInfo = {
          token: !!token,
          loggedOutElement: !!loggedOut,
          loggedInElement: !!loggedIn,
          loggedOutDisplay: loggedOut
            ? getComputedStyle(loggedOut).display
            : "N/A",
          loggedInDisplay: loggedIn
            ? getComputedStyle(loggedIn).display
            : "N/A",
          loggedOutContent: loggedOut ? loggedOut.innerHTML : "N/A",
          loggedInContent: loggedIn ? loggedIn.innerHTML : "N/A",
        };

        document.getElementById("debugInfo").textContent = JSON.stringify(
          debugInfo,
          null,
          2
        );
      }

      // Update debug info every second
      setInterval(updateDebugInfo, 1000);

      // Initial update
      setTimeout(updateDebugInfo, 100);
    </script>
  </body>
</html>
